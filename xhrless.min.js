(function(h){var f="object"==typeof window&&"object"==typeof document,g="object"==typeof module&&"function"==typeof require;if("undefined"==typeof XMLHttpRequest)if(g)XMLHttpRequest=require("xhr2"),"object"==typeof XMLHttpRequest.prototype._restrictedHeaders&&["cookie","cookie2","referer","user-agent"].forEach(function(a){return delete XMLHttpRequest.prototype._restrictedHeaders[a]});else throw Error("XMLHttpRequest is not defined in this environment");var c=function(a,b,d){if("object"!=typeof this||
!(this instanceof c))return new c(a,b,d);this.xhr=new XMLHttpRequest;this.method=d||"";this.url=a||"";this.postData=b||void 0;this.password=this.userName=void 0;this.headers={};this.data={}};c.prototype.ERR_NONE=0;c.prototype.ERR_CONNECTION=1;c.prototype.ERR_HTTPSTATUS=2;c.prototype.ERR_BODYTYPE=3;c.prototype.reset=function(a,b,d){this.method=d||"";this.url=a||"";this.postData=b||void 0;return this};c.prototype.httpAuth=function(a,b){this.userName=a;this.password=b;return this};c.prototype.setTimeout=
function(a){this.xhr.timeout="number"==typeof a&&0<a?a:0;return this};c.prototype.setData=function(a,b){"string"==typeof a&&a.length&&(void 0!==b?this.data[a]=b:this.data.hasOwnProperty(a)&&delete this.data[a]);return this};c.prototype.setHeader=function(a,b){"string"==typeof a&&a.length&&("string"==typeof b&&b.length?this.headers[a]=b:this.headers.hasOwnProperty(a)&&delete this.headers[a]);return this};c.prototype.setHeaders=function(a){this.headers={};if("object"==typeof a)for(var b in a)a.hasOwnProperty(b)&&
"string"==typeof a[b]&&a[b].length&&(this.headers[b]=a[b]);return this};c.prototype.setCookie=function(a,b){"string"==typeof a&&a.length&&"string"==typeof b&&b.length&&(this.headers.Cookie="Cookie"in this.headers?this.headers.Cookie+("; "+a+"="+encodeURIComponent(b)):a+"="+encodeURIComponent(b));return this};c.prototype.setCookies=function(a){var b=[];if("object"==typeof a)for(var d in a)a.hasOwnProperty(d)&&"string"==typeof a[d]&&a[d].length&&b.push(d+"="+encodeURIComponent(a[d]));b.length?this.headers.Cookie=
b.join("; "):this.headers.hasOwnProperty("Cookie")&&delete this.headers.Cookie;return this};c.prototype.onTimeout=function(a){var b=this;this.xhr.ontimeout="function"==typeof a?function(d){return a.call(b,b)}:null;return this};c.prototype.onChange=function(a){var b=this;this.xhr.onreadystatechange="function"==typeof a?function(d){return a.call(b,b)}:null;return this};c.prototype.onReady=function(a){var b=this;this.xhr.onreadystatechange="function"==typeof a?function(d){return b.isCompleted()&&a.call(b,
b)}:null;return this};c.prototype.onSuccess=function(a,b){var d=this;this.xhr.onreadystatechange="function"==typeof a&&"function"==typeof b?function(c){d.isCompleted()&&(d.isSuccessResponse()?a.call(d,d):b.call(d,d))}:"function"==typeof a?function(b){return d.isCompleted()&&d.isSuccessResponse()&&a.call(d,d)}:"function"==typeof b?function(a){return d.isCompleted()&&!d.isSuccessResponse()&&b.call(d,d)}:null;return this};c.prototype.promise=function(a){var b=this;return new Promise(function(d,c){b.xhr.onreadystatechange=
function(a){b.isCompleted()&&(b.isSuccessResponse()?d(b):c(b))};b.send(a)})};c.prototype.readyState=function(){return this.xhr.readyState};c.prototype.status=function(){return this.xhr.status};c.prototype.responseHeaders=function(a){if(!a)return this.xhr.getAllResponseHeaders();a=this.xhr.getAllResponseHeaders().split("\n");for(var b={},d,c,e=0,f=a.length;e<f;++e)c=a[e].indexOf(":"),0<c&&(d=a[e].substr(0,c).trim(),c=a[e].substr(c+1).trim(),d.length&&c.length&&(b.hasOwnProperty(d)?b[d].push(c):b[d]=
[c]));return b};c.prototype.responseHeader=function(a){return this.xhr.getResponseHeader(a)};c.prototype.responseText=function(){return this.xhr.responseText};c.prototype.response=function(){return this.xhr.response};c.prototype.responseType=function(a){if("string"!=typeof a)return this.xhr.responseType;this.xhr.responseType=a;return this};c.prototype.send=function(a){if(this.url)if(a||this.postData){this.xhr.open(this.method||"POST",this.url,!0,this.userName,this.password);for(var b in this.headers)this.xhr.setRequestHeader(b,
this.headers[b]);this.xhr.send(a||this.postData)}else{this.xhr.open(this.method||"GET",this.url,!0,this.userName,this.password);for(b in this.headers)this.xhr.setRequestHeader(b,this.headers[b]);this.xhr.send()}else throw Error("The request URL is empty");return this};c.prototype.abort=function(){this.xhr.abort();return this};c.prototype.isCompleted=function(){return this.xhr.readyState&&(this.xhr.readyState==XMLHttpRequest.DONE||this.xhr.readyState==this.xhr.DONE)};c.prototype.isStatusOK=function(){return 200<=
this.xhr.status&&300>this.xhr.status};c.prototype.isSuccessResponse=function(){return this.isStatusOK()&&(!this.xhr.responseType||null!==this.xhr.response&&void 0!==this.xhr.response)};c.prototype.errorState=function(a){return this.status()?this.isStatusOK()?this.isSuccessResponse()?a?"No error":this.ERR_NONE:a?"Unexpected response body format":this.ERR_BODYTYPE:a?"HTTP "+this.status():this.ERR_HTTPSTATUS:a?"Connection failed":this.ERR_CONNECTION};f&&(c.prototype.loadInto=function(a,b,c){b&&"function"==
typeof this.showPreloader&&this.showPreloader(a);this.responseType("").onReady(function(){"string"==typeof a&&a.length&&(a=document.querySelector(a));if("object"!=typeof a||!(a instanceof Element))throw Error("Invalid node element / CSS selector");this.isStatusOK()?a.innerHTML=this.xhr.responseText:a.innerHTML="function"==typeof c?c(this)||"":c||""}).send();return this},c.prototype.showPreloader=function(a){"string"==typeof a&&a.length&&(a=document.querySelector(a));"object"==typeof a&&a instanceof
Element&&(a.innerHTML='<div class="xhr_preloader" id="xhr_preloader_'+a.id+'" style="height:'+a.clientHeight+"px;width:"+a.clientWidth+'px;margin:0px;padding:0px;"></div>');return this});if(f)window[h]=c;else if(g)module.exports=c;else throw Error("Unsupported environment");})("XHR");
